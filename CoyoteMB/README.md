# BatchMB

This is a collection of tools for the Coyote Batch Toolkit which allow communications across a multicast message bus. This enables Operations Administration and Monitoring (OAM) between instances of Coyote Batch jobs and a centralized manager if desired.

The muilicast protocol is a very simple, lightweight approach to the discovery of and communication with other components in the network. Heartbeats are issued and tracked be each node in the network, and each can determine if problems are reported by another. If a node fails to emit a heartbeat in a particular time window, the other components will notice this and generate events of their own.

## Security Uses

A component under attack can emit last-gasp messages other nodes which can then notify management systems and pick up processing for the lost node. This allows for the implementation of fault tolerance and resilience in the system adding to the availability and integrity of the system.

Multiple components can cover the same unit of work and coordinate its execution providing complete fail-over and fall-back capabilities without external intervention.

Because this uses a multicast protocol which is not normally routed, communications are inherently fire-walled. Network equipment must be specifically configured to route Multicast packets and therefore offer a level of traffic segregation which assists in preventing unauthorized access. Additionally, packets can be signed and encrypted to prevent tampering and forgery. Each packet is sequentially numbered which assists in detecting lost packets, receiving data in the correct order and preventing play-back attacks.

The multicast nature of the communications can enable all nodes in the system to observe the state of all other nodes and generate alarms when suspicious activities are observed. If a node appears to be compromised, all the other nodes can observe aberrant behavious and take immediate action such as alerting management systems and treating all data from that node as suspect. An attacker would have to compromize all nodes simultaneously to prevent being noticed. An due to the locational transparency of Multicast Bus communications, a compromised node never knows what number of other nodes there are, where they are located nor how they operate. A node is completely decoupled from the rest of the system. There is not even a central server (like in other messaging protocols like MQTT or AMQP) to attack.

This protocol is extreamly light weight and immune to single point of failure in the sense there is no centralized broker to fail. The protocol uses only the IP protocol stack on the host which is decoupled from other stacks. Even if the network failed, intra-stack messaging will still continue on the same host, never really disabling the message exchange, only the breadth of transmission (inter-machine exchange).

## Complex Processing Patterns

The Multicast Bus protocol can be used by Readers and Writers to exchange messages with other components in the system as part of normal transformations allowing coordinated data exchanges and complex transformation flows. Listeners can detect failures in transformations, notifying other other transforms through MB Readers which kick off remediation flows. And because the the Multicast Bus is a publish-subscribe protocol, one event can be received by multiple readers allowing the parallelized processing of events. This is particularly useful in optimized Map-Reduced algorithms where many different "mapping" readers will receive the message, but only one will process and respond to it based on the processing rules in each of the readers.

Because multicast messages are used, Publish-Subscribe patterns can be easily implemented. A MB Writer can publish a message, and an external transaction manager can observe that message and ensure a response is generated. If a response is not generated, remediation actions can be taken. In Optimized Map-Reduce, any number of mappers can be created at any time and the event writer only needs to publish the event to the group. This provides locational transparency and complete decoupling from the physical reader instances. All the writer needs is to ensure a response was generated by at least one of the readers. Additionally, one query can be issued to the reader topic and the writer can collect and aggregate (reduce) all the results from all the readers and never need to know anything about the physical deployment or implementation of the responders.

# Operation

If the Batch Jobs sense the existence of an OAM Manager, it is loaded and used by the system. If not, the default OAM Manager is used which is a null, no-op implementation. With mode of operation, many different types of OAM managers can be used, depending on the desired operation.

